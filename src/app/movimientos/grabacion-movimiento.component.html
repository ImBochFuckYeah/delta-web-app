<div class="container-fluid mt-4">
  <div class="card shadow-sm border-0">
    <div class="card-header bg-primary text-white">
      <h3 class="mb-0">GrabaciÃ³n de Movimiento CxC</h3>
    </div>

    <div class="card-body">
      <form [formGroup]="form" (ngSubmit)="submit()">
        <div class="row g-3">
          <!-- Id Saldo Cuenta -->
          <div class="col-md-4">
            <label class="form-label">ID Saldo Cuenta *</label>
            <input type="number" class="form-control" formControlName="idSaldoCuenta" />
            <small *ngIf="cuentaActiva === true" class="text-success">Cuenta ACTIVA</small>
            <small *ngIf="cuentaActiva === false" class="text-danger">Cuenta INACTIVA</small>
          </div>

          <!-- Tipo Movimiento -->
          <div class="col-md-4">
            <label class="form-label">Tipo de Movimiento *</label>
            <select class="form-select" formControlName="idTipoMovimientoCXC">
              <option [ngValue]="null">-- Seleccione --</option>
              <option *ngFor="let t of tipos" [ngValue]="t.IdTipoMovimientoCXC">
                {{ t.Nombre }} ({{ t.OperacionCuentaCorriente === 1 ? 'Cargo' : 'Abono' }})
              </option>
            </select>
          </div>

          <!-- Fecha -->
          <div class="col-md-4">
            <label class="form-label">Fecha Movimiento *</label>
            <input type="datetime-local" class="form-control" formControlName="fechaMovimiento" />
          </div>

          <!-- Valor -->
          <div class="col-md-4">
            <label class="form-label">Valor *</label>
            <input type="number" step="0.01" class="form-control" formControlName="valorMovimiento" />
          </div>

          <!-- Documento -->
          <div class="col-md-4">
            <label class="form-label">Documento Ref</label>
            <input class="form-control" formControlName="documentoRef" />
          </div>

          <!-- DescripciÃ³n -->
          <div class="col-md-12">
            <label class="form-label">DescripciÃ³n</label>
            <textarea rows="2" class="form-control" formControlName="descripcion"></textarea>
          </div>
        </div>
      </div>
    </div>

        <div class="mt-4">
          <button class="btn btn-primary" type="submit" [disabled]="enviando">
            <span *ngIf="enviando" class="spinner-border spinner-border-sm me-2"></span>
            Guardar
          </button>
          <span *ngIf="enviando" class="ms-2 text-muted">Procesandoâ€¦</span>
        </div>

        <div *ngIf="mensaje" class="alert alert-info mt-3">{{ mensaje }}</div>
      </form>

      <ng-container *ngIf="resultado">
        <div *ngIf="resultado.mov" class="mt-4">
          <h5>âœ… Movimiento creado</h5>
          <pre class="bg-light p-2 rounded">{{ resultado.mov | json }}</pre>
        </div>

        <div *ngIf="resultado.saldo" class="mt-3">
          <h5>ðŸ’° Saldo actualizado</h5>
          <pre class="bg-light p-2 rounded">{{ resultado.saldo | json }}</pre>
        </div>
      </ng-container>
    </div>
  </div>
</div>
