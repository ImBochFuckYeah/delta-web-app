<div class="container mt-4">
  <h2>Gestión de Personas</h2>

  <div class="row mb-3">
    <div class="col-md-6">
      <div class="input-group">
        <input class="form-control" placeholder="Buscar por nombre, correo..."
               [(ngModel)]="searchTerm" (keyup.enter)="onSearch()">
        <button class="btn btn-primary" (click)="onSearch()" [disabled]="loading">
          <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>Buscar
        </button>
      </div>
    </div>
    <div class="col-md-6 text-end">
      <a class="btn btn-success" routerLink="/app/persona.php/crear"><i class="bi bi-plus-circle"></i> Nueva Persona</a>
    </div>
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead>
      <tr>
        <th>ID</th><th>Nombre</th><th>Apellido</th><th>Correo</th><th>Teléfono</th><th>Acciones</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let p of personas">
        <td>{{p.IdPersona}}</td>
        <td>{{p.Nombre}}</td>
        <td>{{p.Apellido}}</td>
        <td>{{p.CorreoElectronico}}</td>
        <td>{{p.Telefono}}</td>
        <td>
          <a class="btn btn-sm btn-primary me-2" [routerLink]="['/app/persona.php/editar', p.IdPersona]">Editar</a>
          <button class="btn btn-sm btn-danger" (click)="eliminar(p.IdPersona!)">Eliminar</button>
        </td>
      </tr>
      <tr *ngIf="!loading && personas.length===0"><td colspan="6" class="text-center">Sin resultados</td></tr>
      </tbody>
    </table>
  </div>

  <nav *ngIf="totalPages>1">
    <ul class="pagination justify-content-center">
      <li class="page-item" [class.disabled]="page===1"><a class="page-link" (click)="onPageChange(page-1)">Anterior</a></li>
      <li class="page-item" *ngFor="let p of pages" [class.active]="p===page"><a class="page-link" (click)="onPageChange(p)">{{p}}</a></li>
      <li class="page-item" [class.disabled]="page===totalPages"><a class="page-link" (click)="onPageChange(page+1)">Siguiente</a></li>
    </ul>
  </nav>
</div>
