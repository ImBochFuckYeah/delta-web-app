<div class="container mt-4">
  <h2>Gestión de Cuentas</h2>



  <!-- Barra de búsqueda y botón nuevo -->
  <div class="row mb-3">
    <div class="col-md-6">
      <div class="input-group">
        <input
          type="text"
          class="form-control"
          placeholder="Buscar cuenta por nombre..."
          [(ngModel)]="buscar"
          (keyup.enter)="onSearch()">
        <button
          class="btn btn-primary"
          (click)="onSearch()"
          [disabled]="loading">
          <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
          Buscar
        </button>
      </div>
    </div>

    <div class="col-md-6 text-end">
      <a
        class="btn btn-success"
        routerLink="/app/saldo-cuentas/crear"
        >
        <i class="bi bi-plus-circle"></i> Nueva Cuenta
      </a>
    </div>
  </div>

  <!-- Tabla de resultados -->
  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>IdSaldoCuenta</th>
          <th>Persona</th>
          <th>Tipo</th>
          <th>Estado</th>
          <th>SaldoAnterior</th>
          <th>Débitos</th>
          <th>Créditos</th>
          <th>SaldoActual</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let c of data">
          <td>{{ c.IdSaldoCuenta }}</td>
          <td>{{ c.NombrePersona }}</td>
          <td>{{ c.TipoSaldoCuenta }}</td>
          <td>{{ c.EstadoCuenta }}</td>
          <td>{{ c.SaldoAnterior | number:'1.2-2' }}</td>
          <td>{{ c.Debitos | number:'1.2-2' }}</td>
          <td>{{ c.Creditos | number:'1.2-2' }}</td>
          <td><strong>{{ c.SaldoActual | number:'1.2-2' }}</strong></td>
          <td>
            <!-- Editar -->
            <a
              class="btn btn-sm btn-primary me-2"
              [routerLink]="['/app/saldo-cuentas/editar', c.IdSaldoCuenta]">
              Editar
            </a>

            <!-- Consultar saldo -->
            <a
              class="btn btn-sm btn-outline-secondary"
              [routerLink]="['/app/consulta-saldos']"
              [queryParams]="{ id: c.IdSaldoCuenta }">
              Saldo / Movs
            </a>
          </td>
        </tr>
        <tr *ngIf="!loading && data.length === 0">
          <td colspan="9" class="text-center">Sin resultados</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Paginación -->
  <nav *ngIf="totalPages > 1">
    <ul class="pagination justify-content-center">
      <li class="page-item" [class.disabled]="page === 1">
        <a class="page-link" (click)="onPageChange(page - 1)">Anterior</a>
      </li>
      <li
        class="page-item"
        *ngFor="let p of pages"
        [class.active]="p === page">
        <a class="page-link" (click)="onPageChange(p)">{{ p }}</a>
      </li>
      <li class="page-item" [class.disabled]="page === totalPages">
        <a class="page-link" (click)="onPageChange(page + 1)">Siguiente</a>
      </li>
    </ul>
  </nav>

  <!-- Loader -->
  <div *ngIf="loading" class="text-center mt-3">
    <div class="spinner-border text-primary">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>
</div>
