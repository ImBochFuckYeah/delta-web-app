<div class="container mt-4">
  <h2>Gesti√≥n de Cuentas</h2>

  <div class="row g-2 mb-3">
    <div class="col-md-3">
      <input class="form-control" type="number" placeholder="IdPersona (opcional)" [(ngModel)]="idPersona">
    </div>
    <div class="col-md-5">
      <input class="form-control" placeholder="Buscar por nombre/apellido/correo..." [(ngModel)]="buscar" (keyup.enter)="onSearch()">
    </div>
    <div class="col-md-4 text-end">
      <!-- ‚úÖ Crear nueva cuenta -->
      <a class="btn btn-success" routerLink="/app/saldo-cuentas/crear">
        <i class="bi bi-plus-circle"></i> Nueva cuenta
      </a>

      <!-- üîç Buscar -->
      <button class="btn btn-primary ms-2" (click)="onSearch()" [disabled]="loading">
        <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>Buscar
      </button>
    </div>
  </div>

  <!-- Tabla de resultados -->
  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>IdSaldoCuenta</th>
          <th>Persona</th>
          <th>Tipo</th>
          <th>Estado</th>
          <th>SaldoAnterior</th>
          <th>D√©bitos</th>
          <th>Cr√©ditos</th>
          <th>SaldoActual</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let c of data">
          <td>{{ c.IdSaldoCuenta }}</td>
          <td>{{ c.NombrePersona }}</td>
          <td>{{ c.TipoSaldoCuenta }}</td>
          <td>{{ c.EstadoCuenta }}</td>
          <td>{{ c.SaldoAnterior | number:'1.2-2' }}</td>
          <td>{{ c.Debitos | number:'1.2-2' }}</td>
          <td>{{ c.Creditos | number:'1.2-2' }}</td>
          <td><strong>{{ c.SaldoActual | number:'1.2-2' }}</strong></td>
          <td>
            <!-- ‚úÖ Editar cuenta -->
            <a class="btn btn-sm btn-primary me-2"
               [routerLink]="['/app/saldo-cuentas/editar', c.IdSaldoCuenta]">
              Editar
            </a>

            <!-- ‚úÖ Consultar saldo -->
            <a class="btn btn-sm btn-outline-secondary"
               [routerLink]="['/app/consulta-saldos']"
               [queryParams]="{ id: c.IdSaldoCuenta }">
              Saldo / Movs
            </a>
          </td>
        </tr>
        <tr *ngIf="!loading && data.length === 0">
          <td colspan="9" class="text-center">Sin resultados</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- ‚úÖ Paginaci√≥n -->
  <nav *ngIf="totalPages > 1">
    <ul class="pagination justify-content-center">
      <li class="page-item" [class.disabled]="page === 1">
        <a class="page-link" (click)="onPageChange(page - 1)">Anterior</a>
      </li>
      <li class="page-item" *ngFor="let p of pages" [class.active]="p === page">
        <a class="page-link" (click)="onPageChange(p)">{{ p }}</a>
      </li>
      <li class="page-item" [class.disabled]="page === totalPages">
        <a class="page-link" (click)="onPageChange(page + 1)">Siguiente</a>
      </li>
    </ul>
  </nav>
</div>
